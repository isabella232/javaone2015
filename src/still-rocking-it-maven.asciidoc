=  Still Rocking It: A Dozen Demos and Great News for Apache Maven Users
:title: Still Rocking It: A Dozen or More Demos and Great News for Apache Maven Users
:Author:  Jason van Zyl and  Manfred Moser 
:Date: October 2015
:max-width: 45em
:icons:
:copyright: Copyright 2015-present, Takari and simpligility, All Rights Reserved.
:incremental:

== Apache Maven - Still Rocking It
:incremental!:

[quote]
A Dozen Demos and Great News for Apache Maven Users

Jason van Zyl 

* Apache Maven Founder / http://twitter.com/jvanzyl[@jvanzyl]  / http://www.takari.io[www.takari.io]

Manfred Moser

* Apache Maven Committer and Trainer / http://twitter.com/simpligility[@simpligility] / http://www.simpligility.com[www.simpligility.com]

TIP: Hold on tight, this is going to be a wild ride!

== What Are You Going to Learn? 

* Tips & tricks
* Best practices
* New tools, plugins, ...

-> Lots of stuff happening in the Apache Maven ecosystem!

== Before We Get Started 
:incremental!:

* Maven is opinionated...
* And so are the developers!
* Follow best practices, to make your life easier

And...

* Maven is open source
* Work happens on latest code
* Old releases receive no attention or support
* There is no one company behind Maven - its a community!

TIP: Don't worry! It's not bad, it's good!

== Do NOT Use Old Maven Versions
:incremental:

* Maven 1 - doh!
* Maven 2 - seriously, just don't do it!
* Maven Ant Tasks - nope, based on Maven 2 and unmaintained
* Maven 3.0.x - old but stable != should be used
* Maven 3.1.x - old with issues ! = should be used
* Maven 3.2.x - new but not latest supported ! = should be used

-> Unless you are prepared to maintain those projects yourself, use Maven 3.3.3

TIP: And keep up to date with newer releases!

== Avoid Other Old Stuff 
:incremental!:

Be careful about

* IDEs using old Maven versions
* Using different version on command line / CI server
* Old IDE plugins
* Old Maven plugins
* JDK 4, 5, 6, and 7 usage

== Now Let's Get Started
:incremental!:

We will look at things that ...

* Simplify project build
* Control project build
* Improve development
* And build performance
* Provide new tools
* And much more

== Where Are We At?

* Apache Maven 3.3.3
* Apache Maven Plugins - require 3+
* Java 1.7+ for build execution
* Codehaus Plugins migrated to http://www.mojohaus.org/[MojoHaus]

== Misc Newer 'Small' Features

* JSR330-based injection for extensions and plugin
* Transitive dependency excludes
* Pluggable reactor
* Version values allow `${revision}`, `${sha1}`, `${changelist}`
* Version ranges in parent
* Central Repository defaults to HTTPS

== Maven Wrapper
:incremental!:

* Unix and Windows scripts 
* Within project structure - version controlled
* Automatic download and install of Maven
* Uses `~/.m2/wrapper`
* Removes need to provision Maven
* For developer and CI server provisioning
* Specifies Maven version


== Maven Wrapper
:incremental!:

----
mvn -N io.takari:maven:wrapper
----

And then just use similar commands to 

----
./mvnw clean install
mvn.bat clean install
----


== .mvn Configuration
:incremental!:

* Project-local configuration folder
* Version controlled with source
* Maven 3.3.1+
* Controls how project is built
* Allows for extension loading
* In root folder of multi-module project

== .mvn JVM Configuration
:incremental!:

* No more global, polluted `MAVEN_OPTS`
* `.mvn/jvm.config`: 

----
-Xmx8192m
----

== .mvn Maven Configuration
:incremental!:

* `.mvn/maven.config`
* Maven invocation parameters

----
--T 8
--builder smart
--U
----

== Core Extensions
:incremental!:

Allow different Maven behavior e.g.: 

* Local repository access
* Reactor ordering
* Parse pom in different syntax - Polyglot Maven 
* Large potential, but be careful...

== Core Extensions
 
`.mvn/extensions.xml`:

----
<?xml version="1.0" encoding="UTF-8"?>
<extensions>
  <extension>
    <groupId>io.takari.maven</groupId>
    <artifactId>takari-smart-builder</artifactId>
    <version>0.4.1</version>
  </extension>
  <extension>
    <groupId>io.takari.aether</groupId>
    <artifactId>takari-concurrent-localrepo</artifactId>
     <version>0.0.7</version>
  </extension>
</extensions>
----

== Control Your Tools
:incremental!:

Beyond wrapper and .mvn

* Control plugin versions 
** e.g. extend https://github.com/simpligility/progressive-organization-pom[progressive-organization-pom]
** various Maven controlled parents
* Use http://maven.apache.org/enforcer/maven-enforcer-plugin/[Enforcer plugin]
** with standard or http://www.mojohaus.org/extra-enforcer-rules/[extra rules]
** or write your own rules

== Extensions Examples
:incremental!:

* Concurrent repo access
** TBD detail what it does and why
* Smart builder
** TBD detail about it .. see next slides.. 

== Reactor Improvements
:incremental!:

Traditional Parallel

----
mvn -T 4 clean deploy
----

Takari Smart Builder

----
mvn clean deploy --builder smart -T4
----

TBD - insert image from docs, link to docs

== Polyglot Maven
:incremental!:

* Support for POM written in 
** Groovy
** YAML
** Ruby
** Others
* Produces POM for deployment and tool support
* https://github.com/takari/polyglot-maven[Project] and 
https://github.com/takari/polyglot-maven-examples[Examples] available

== JRuby Build

* Uses Maven
* And Maven Wrapper
* Polyglot Maven `pom.rb`

----
<extension>
  <groupId>io.takari.polyglot</groupId>
  <artifactId>polyglot-ruby</artifactId>
  <version>0.1.11</version>
</extension>
----

TIP: https://github.com/jruby/jruby[Check it out.]

== SnakeYAML

* Uses Maven 
* And Maven Wrapper
* Polyglot Maven `pom.yaml`

----
<extension>
  <groupId>io.takari.polyglot</groupId>
  <artifactId>polyglot-yaml</artifactId>
  <version>0.1.12</version>
</extension>
----

TIP: See the https://bitbucket.org/asomov/snakeyaml/src[source.]

== Maven Shell
:incremental!:

https://github.com/takari/takari-shell

tbd WHERE

== Takari Lifecycle
:incremental!:


http://takari.io/book/40-lifecycle.html#the-takari-lifecycle

* extensions
* takari-jar packaging
* one plugin for whole lifecycle
* incremental build library

== Incremental Example
:incremental!:

Example of to make incremental plugin (antlr build)

== Maven Testing Tools and Beyond
:incremental!:

test project generator from dot files

proto plugin - archetype replacement - maybe

== Plugin Testing
:incremental!:

plugin testing framework including IDE support

== Plugin Testing Examples
:incremental!:

Android Maven Plugin and NDK Plugin
Show config and IDE integration and such

== Generations
:incremental!:

maybe .. depending on status, at least update what is there and what is coming

== Maven Development Tools
:incremental!:

Awesome for Maven dev and plugin dev
Have M2e run Maven from within workspace



== Eclipse and M2e
:incremental!:

* including polyglot extensions from Fred
* Maven dev tools
* Maybe some web app

== IntelliJ
:incremental!:

IntelliJ - change request, push Jetbrains 

== Netbeans
:incremental!:

?? tbd - download and check it out

== Central Repository - Now

* HTTPS
* International, high performance CDN
* Supported by Sonatype

== Central Repository - Next

Full replication to Google Cloud Storage:

* Playground for data-mining and exploration
* Experiments with new features like
** https://http2.github.io/[HTTP/2] (evolved SPDY)
** Search service
** more.. 
 
== Other Cool Stuff
:incremental!:

Lots of things happening: 

* Evolving Apache and Mojohaus plugins
* Docker Maven Plugins from https://github.com/spotify/docker-maven-plugin[spotify] and others
* http://simpligility.github.io/android-maven-plugin/[Android Maven Plugin] and beyond
* https://github.com/maven-nar[Maven NAR] 
* Various JS and web development related plugins
* https://github.com/simpligility/maven-repository-tools[Maven Repository Tools]
* flatten-maven-plugin

== Summary
:incremental!:

* Lots of things are moving
* We only touched the tip of the iceberg
* What did you contribute?

== Next?
:incremental!:

Join us for a Maven Hangout On Air -TBD link insert to x

* Demo your solution or tip
* Ask your question
* Discuss user questions
* And developer questions

== The End 
:incremental!:

Questions, Remarks &  Discussion

TIP: Slides and examples at http://takari.github.io/javaone2015/[http://takari.github.io/javaone2015/]

== Other Resources
:incremental:

* http://takari.io/book/index.html[TEAM documentation]

